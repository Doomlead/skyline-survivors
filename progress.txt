# Skyline Survivors: Urban Defender

## 1. Core Concept

**Implementation Status: 78% Complete**  

### Key Themes Progress:

✅ **Fully Implemented:**
- Urban defense gameplay with district-based missions
- Ship/foot combat transitions via pilot ejection system
- Human rescue mechanics with landers and mutants
- Escalating difficulty through wave systems and boss encounters
- **Defend and Reclaim**: Districts exist in three states (Friendly/Threatened/Occupied)
- **Squad Leader Fantasy (Core Loop):** On-foot aura, formation follow, and sacrifice/body-block behaviors
- **Active Deployment:** Humans convert into operatives when dropped at the hangar

⚠️ **Partially Implemented:**
- **Seamless transition (Ship/Foot):** Ejection + hangar rebuild + squad leader aura exist, but Bulwark/ground synergies and stronger UI messaging are missing.
- **Resource vs. Score (The Rescue Loop):** Cargo collection + deployment are in place, but tier overflow and squad synergy feedback are missing.
- **Strategic Territory Control:** District states and timers exist, but the "Loss Aversion" investment/prosperity mechanics are missing.
- **Operative Depth:** 4 distinct classes exist with combat behaviors (Infantry, Gunner, Medic, Saboteur), but stronger fire-team coordination outside of the on-foot formation and Tier Overflow scaling are missing.

---

## 2. High-Level Structure

### 2.1. System View Orbital Map

**Implementation Status: 88% Complete**

✅ **Fully Implemented:**
- 3D rotating globe with selectable districts
- **City districts** displayed as nodes with three states (Friendly, Threatened, Occupied)
- **Battleships** roam between nodes
- **Special node:** Mothership (Endgame)
- Consequence system: Threatened → Occupied
- **Victory Condition:** Complete Mothership assault
- Threat timer-based urgency and pulsing visuals for threatened districts
- Critical urgency logic drives spawn/reward multipliers

⚠️ **Partially Implemented:**
- **The "Near-Miss" Timer:** Critical state exists via timer ratio, but no explicit 30s "CRITICAL" window or clutch-defense bonus callout.

❌ **Not Implemented:**
- **District Investment Levels (Dark Pattern):** Friendly districts accumulating "Prosperity Multiplier" (Loss Aversion mechanic).

### 2.2. Side-Scrolling Combat View

**Implementation Status: 78% Complete**

#### Defense Missions (Threatened Districts)
**Implementation Status: 82% Complete**
✅ **Fully Implemented:**
- Defend districts (15 waves) / Wave tier progression
- Mini-boss and boss encounters / Battleship encounter
- Extraction hub hangar with landing zone rebuild pad
- **Deployment Animation:** Dropping off cargo spawns operative squads

#### Assault Missions (Occupied Districts)
**Implementation Status: 75% Complete**
✅ **Fully Implemented:**
- Base core objective with HP / Shield generators / Turrets
- Garrison defender squads
- **Saboteur Synergy:** EMP-style disables against turrets/shields

❌ **Not Implemented:**
- **Bulwark Form Synergy:** Increased effectiveness against structures
- **Assault Rewards:** Loot drops and jackpots on base destruction

---

## 3. Gameplay Overview & The Rescue Loop

### 3.1 The Rescue & Drop-Off Loop (New v2.0 Section)

**Implementation Status: 88% Complete**

✅ **Fully Implemented:**
- Basic Human Rescue (picking up a human)
- **"Strike Force" Carry:** Multiple humans stored in cargo with HUD indicator
- **Inertia Scaling:** Ship physics change based on cargo count
- **Tactical Deployment:** Dropping humans at the Hangar spawns AI Comrades

⚠️ **Partially Implemented:**
- **Operative Scaling Feedback:** Squad size and power scaling lacks strong UI/FX feedback loops

### 3.2 Core Loop

**Implementation Status: 85% Complete**
✅ **Fully Implemented:**
- System Map -> Combat -> Upgrade cycle
- Ship Destruction -> Ejection
- Crisis Management: on-foot rebuild by holding the landing zone under the hangar

---

## 4. Player Mechanics & Operative Systems

### 4.1. Ship Forms & Movement

**Implementation Status: 90% Complete**

✅ **Fully Implemented:**
- **Normal Interceptor Form:** 8-directional movement, Primary Weapon, Smart Bomb, Hyperspace
- **Bulwark Form:** Toggle, Slowed movement, 360° aim

⚠️ **Partially Implemented:**
- **Bulwark Assault Synergy:** No structural damage or siege bonuses yet

### 4.2. Operative AI & Combat Behavior ("The Comrades")

**Implementation Status: 80% Complete**

✅ **Fully Implemented:**
- Operative spawning from hangar deployment
- **Operative Classes:** Infantry, Gunner, Medic, Saboteur
- **Formation + Aura:** On-foot squad formation, fire-rate aura, and formation offsets
- **Saboteur Assault Logic:** Assault targets prioritized with EMP disable

⚠️ **Partially Implemented:**
- **Fire-Team Coordination:** Patrol behaviors exist, but stronger group coordination and defensive perimeter logic are still minimal when the pilot is airborne.
- **Weapon Synergy:** Tier 3 ship overflow upgrading ground troops is missing.

### 4.3. On-Foot Command (Ship Destruction)

**Implementation Status: 82% Complete**

✅ **Fully Implemented:**
- Ejection Sequence (Pilot sprite, basic pistol)
- **Extraction Defense:** Hold the landing zone under the hangar for 30s to rebuild the Aegis (with UI prompt)
- **Squad Leader Aura:** Comrades follow pilot movement in formation, boost fire rate, and re-anchor to the pilot
- **Sacrifice Mechanic:** Operatives body-block incoming projectiles during rebuild

⚠️ **Partially Implemented:**
- **Rebuild Feedback:** Needs clearer HUD emphasis for when sacrifice behavior is active

### 4.4. Power-Up System

**Implementation Status: 70% Complete**

✅ **Fully Implemented:**
- Core Weapons (Laser, Spread, Missiles) - 3 Tiers
- Defensive (Shields, Speed)
- Utility (Smart Bombs, Multipliers)
- Weapon Decay & Switching

❌ **Not Implemented:**
- **Tier 3 Overflow:** Logic to detect Max Tier and redirect power-up to Ground Troop stats
- **Assault Rewards:** Base destruction dropping specific loot
- **Mystery Drops:** Random effects/Jackpots

---

## 5. Enemy Design

**Implementation Status: 100% Complete**
✅ **Fully Implemented:**
- Landers, Mutants, Bombers, Pods, Baiters, Swarmers
- Advanced variants (Kamikaze, Turret, Shield, Seeker, etc.)
- Bosses (Mega Lander, Titan Mutant, etc.)
- Mothership core boss flow

---

## 6. Game Systems

### 6.1. Radar / HUD

**Implementation Status: 82% Complete**

✅ **Fully Implemented:**
- Radar (Player, Enemies, Objectives)
- Mission Objectives (Wave Count / Base HP)
- Threat/urgency display and pulsing map indicators
- Mothership HUD phase and core health

❌ **Not Implemented:**
- **Dark Patterns:** Engagement "Combo Meter" and explicit near-miss clutch bonus

### 6.2. Meta Progression (Shop)

**Implementation Status: 88% Complete**

✅ **Fully Implemented:**
- Supply Drop Gacha (Credits, Unboxing, Loot History)
- Pending supply drop inventory display
- **Inventory Hot-Starts:** Supply drop items apply at mission start with HUD callout

---

## 7. Environment Design

**Implementation Status: 60% Complete**

✅ **Fully Implemented:**
- Multi-layer parallax (Sky, City, Street)
- Extraction hub hangar with ground landing zone
- Multiple biome background generators (industrial/cyberpunk/wasteland/mothership)

❌ **Not Implemented:**
- Dynamic Weather/Time of Day

---

## MVP Completion

- **Status:** ~74% complete (core loop intact, Mothership core fight present but simplified)
- **Primary Blockers:** Multi-phase Mothership mission, tier overflow/comrade scaling, strategic pressure systems, assault rewards + bulwark siege bonuses

## Gap Analysis & Next Steps

### Overall Completion Statistics
- **MVP Completion:** ~74% (Core rescue/deploy loop, on-foot aura, and district flow are playable with supply-drop hot-starts.)
- **Design Document Alignment:** ~67% (Key systems exist, but several signature mechanics are still missing.)
- **Major Milestones Achieved:** Rescue/Deploy loop, district states, assault/defense modes, hangar rebuild, operative spawning + formation + sacrifice behaviors, supply drop unboxing + hot-start application, mothership core encounter.

### Design Document Alignment
**Aligned/Implemented**
- District state system (Friendly/Threatened/Occupied).
- Rescue-to-Deploy loop (cargo carry, inertia, hangar drop-off, operative deployment).
- Assault/Defense mission flows with hangar rebuild loop.
- On-foot squad aura + sacrifice behavior.
- Supply Drop gacha shop + hot-start delivery at mission start.
- Mothership unlock node and boss encounter.

**Partially Aligned**
- Operative depth (classes exist; patrol behavior exists; missing squad upgrades from weapon overflow).
- Strategic layer urgency (Threatened/Occupied exists; critical urgency exists; missing explicit near-miss/clutch bonus and prosperity investment feedback).
- Bulwark form (functional, but no siege/structure bonus or UI feedback).

**Not Aligned**
- Prosperity/loss aversion investment system.
- Combo/urgency feedback loops (combo meter, clutch defense bonus).
- Tier 3 overflow upgrades for operatives.
- Assault rewards and mystery drops.
- Multi-phase mothership mission structure (exterior → interior → core).

### Major Milestones Achieved
- Ship/foot transition with pilot ejection and hangar rebuild.
- Cargo-based inertia and operative deployment.
- On-foot aura + body-blocking sacrifice loop.
- Assault base objective with garrisons/turrets/shield nodes.
- Supply Drop shop, unboxing, pending drop display, and mission-start hot-start application.
- Mothership node unlock and core boss flow.

### Critical Missing Features for Design Document Compliance
1. **Weapon Tier Overflow:** Redirect max-tier ship pickups to comrade scaling.
2. **Strategic Pressure Systems:** Prosperity/loss aversion, explicit near-miss clutch bonus, combo meter.
3. **Bulwark Assault Synergy:** Higher structural damage or siege bonuses.
4. **Assault Loot Rewards & Mystery Drops:** Base destruction rewards and random jackpots.
5. **Multi-phase Mothership Mission:** Exterior → interior → core progression with phase-gated objectives.

### Immediate Next Steps (Recommended Order)
**Priority 1: Weapon Tier Overflow → Operative Buffs (2-3 Days)**
- Detect max-tier pickups and redirect to ground troops (damage/fire rate/HP).
- Add FX/HUD feedback for comrade upgrades.

**Priority 2: Strategic Pressure & Near-Miss Clutch Bonus (3-4 Days)**
- Add explicit 30s "CRITICAL" near-miss window.
- Add clutch defense bonus and combo meter to reinforce urgency.
- Add prosperity investment loop to friendly districts.

**Priority 3: Bulwark Assault Synergy + Assault Rewards (2-3 Days)**
- Add structural damage bonus for Bulwark mode.
- Add assault base loot drops and mystery jackpots.

**Priority 4: Expand Mothership Final Boss Mission (4-6 days)**
- Build Phase 1 exterior assault + phase transition setup.
- Implement Phase 2 interior encounter space (on-foot focus) with objective gating.
- Upgrade Phase 3 core boss to multi-step shield/HP phases (current fight is HP-based, single arena).
- Add phase-gated UI beats and cinematic transition (dock/boarding).

**Priority 5: Feedback + UI Polish (2 Days)**
- Stronger UI/FX for operative scaling, rebuild sacrifice, and squad power-ups.


### Estimated Remaining Work

### MVP Completion:
- **Current Progress:** ~74% complete (adjusted after code audit)
- **Remaining Critical Work:**
  - Mothership Boss Mission (multi-phase upgrade): 4-6 days
  - Weapon Overflow & Comrade Buff Feedback: 2-3 days
  - Strategic Pressure Systems (near-miss, combo meter, prosperity): 3-4 days
  - Bulwark Assault Synergy + Assault Rewards: 2-3 days
  - Assault failure/retreat polish: 1-2 days
  - UI/FX Feedback Polish: 2 days
- **Total to v2.0 MVP:** ~14-20 Days (feature-implementation + polish)

### Full Design Document:
- **High Priority Features:** ~35% remaining
  - Assault mission polish (multi-phase core, base rewards)
  - Strategic campaign layer + planetary control tracker
  - Enhanced rewards system + post-boss presentation polish
- **Medium Priority Features:** ~60% remaining
  - Ground combat depth (operatives, weapons, cover)
  - Power-up progression tiers (homing, drone, laser)
  - Environmental variety (weather, day/night, district themes)
- **Low Priority Features:** ~85% remaining
  - Additional game modes
  - District themes
  - Challenge systems




### Post-MVP Polish (Optional)
- Dynamic weather/time-of-day cycles.
- Additional district visual states and destruction feedback.
- Extended audio feedback for rescue/deploy and mission transitions.
- Implement multi-phase core reactor.
- Add high-value power-up drops in bases.
- Polish assault difficulty scaling.
- District value indicators.
- Global difficulty scaling tied to occupied districts
- Battleship “kidnap” mechanic for shop items

### What We Should Work on Next
1. **Weapon Tier Overflow → Operative Buffs**. It directly connects the core rescue loop to squad power, reinforces the comrade fantasy from the design doc, and unlocks a clear UI/FX feedback opportunity.
2. **Strategic Pressure Systems** (prosperity + clutch bonus + combo meter) to make the district layer emotionally meaningful and to amplify urgency on the map.
3. **Mothership multi-phase upgrade (Exterior → Interior → Core)**. This is the single largest compliance gap and the primary MVP blocker.
4. **Bulwark assault synergy + assault reward drops** to differentiate assault missions and pay off the Bulwark mode fantasy.
5. **Assault mission retreat/redo loop polish** to clarify failure flow and reduce dead-end friction.
