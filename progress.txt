# Skyline Survivors: Urban Defender - Implementation Progress

## 1. Core Concept

**Implementation Status: 60% Complete**

### Key Themes Progress:

‚úÖ **Implemented:**
- Urban defense gameplay with district-based missions
- Ship/foot combat transitions via pilot ejection system
- Human rescue mechanics with landers and mutants
- Escalating difficulty through wave systems and boss encounters
- **Defend and Reclaim**: Districts exist in three states - friendly, threatened, or enemy-occupied

‚ùå **Missing:**
- Seamlessly transition between piloting a strike ship and fighting on foot when destroyed (basic version exists, needs depth)
- Rescue armed ground operatives to aid in combat (rescue exists, operative squad system missing)
- Dynamic front lines with strategic territory control

---

## 2. High-Level Structure

### 2.1. System View Orbital Map

**Implementation Status: 50% Complete**

‚úÖ **Implemented:**
- 3D rotating globe with selectable districts
- District nodes with status indicators (friendly/threatened/occupied)
- Special nodes: Weapons Satellite (Shop), relay stations, distress beacons
- District selection and launch flow
- Threat indicators with pulsing urgency rings and under-attack highlights
- District timers and state persistence
- Roaming mothership markers with travel/assault phases
- Mothership assaults drain district timers and flag districts as under attack
- Orbit node timers and status readouts in the build mission panel
- **City districts** displayed as nodes with three states:
  - üü¢ **Friendly** (Secured) - No immediate action needed
  - üü° **Threatened** (Under Attack) - Requires defense
  - üî¥ **Occupied** (Enemy Controlled) - Requires assault

‚ùå **Missing:**
- **Battleships** roam between nodes, attacking friendly districts (current "motherships" need renaming and behavior changes)
- **Special nodes:**
  - **Mothership** (Final Endgame Target - unlocked when all districts secured)
  - Challenge Missions (nodes are visual only)
- **Mechanics:**
  - **Defensive Missions:** Select threatened districts to defend from 15 waves
  - **Assault Missions:** Attack occupied districts to destroy enemy ground bases
  - **Consequence System:** Ignoring threatened districts ‚Üí District falls to enemy control ‚Üí Becomes assault mission
  - **Victory Condition:** Secure all districts ‚Üí Unlock Mothership assault

---

### 2.2. Side-Scrolling Combat View

**Implementation Status: 60% Complete**

**Perspective:** ‚úÖ Horizontal wraparound map above a cityscape

#### Defense Missions (Threatened Districts)
**Implementation Status: 70% Complete**

‚úÖ **Implemented:**
- Wave-based enemy spawning system
- Human rescue mechanics
- Power-up collection
- Mini-boss and boss encounters

‚ùå **Missing:**
- Defend district from **exactly 15 waves** (current system is variable)
- Rescue armed ground operatives (**comrades** - basic rescue exists, operative squad missing)
- Extract after wave 15 to **secure district** (state change not implemented)

#### Assault Missions (Occupied Districts)
**Implementation Status: 0% Complete**

‚ùå **Missing - Complete System:**
- Destroy all enemy forces in the district
- **Primary Objective:** Destroy the enemy ground base
- Ground base has defensive turrets, shields, and garrison forces
- Success: District returns to friendly control
- Failure: Retreat and retry (district remains occupied)

**Key Features:**
‚úÖ **Implemented:**
- Radar HUD (Defender-style)
- Parallax cityscape (basic version)

‚ùå **Missing:**
- Dynamic weather/day-night cycle
- Mission type affects enemy composition and objectives

---

### 2.3. Meta Progression

**Implementation Status: 40% Complete**

‚úÖ **Implemented:**
- District clearing tracking
- Meta progression scaffolding (credits, unlocks, loadouts)
- Persistent storage and run history
- Failed defense consequences (district destruction states)

‚ùå **Missing:**
- **Planetary Control Tracker:** Visual representation of friendly vs. occupied territories
- **Battleship Threat System:** Roaming battleships target friendly districts over time
- **Mothership Unlock:** Only accessible when all districts are secured (none occupied)
- **Dynamic Difficulty:** More occupied districts = stronger battleship presence

---

## 3. Gameplay Overview

### 3.1 Core Loop

**Implementation Status: 50% Complete**

‚úÖ **Implemented (Partial):**
1. **System Map:** District selection and status viewing
3. **Combat Mission:** Ship combat, human rescue, mission completion
4. **Extract/Upgrade:** Return to system map, shop access, district status checks

‚ùå **Missing:**
1. **System Map:** Assess planetary situation
   - Identify **threatened districts** (defense needed) vs **occupied districts** (assault needed)
   - Track roaming **battleships**

2. **Mission Selection:**
   - **Defense Mission:** Protect threatened district from 15 waves
   - **Assault Mission:** Destroy enemy base in occupied district

3. **Combat Mission:**
   - If ship destroyed: Fight on foot **with rescued operatives** (operative squad missing)
   - **Assault missions require destroying fortified ground base**

5. **Campaign Progression:**
   - Secure all districts ‚Üí Unlock Mothership
   - Assault Mothership ‚Üí Victory

---

## 4. Player Mechanics

### 4.1. Ship Forms & Movement

#### 4.1.1. Normal Fighter Form
**Implementation Status: 100% Complete ‚úÖ**

‚úÖ **Fully Implemented:**
- Movement: 8-directional, slight inertia
- Primary Weapon: Forward blaster (direction matches facing)
- Secondary Actions:
  - Smart Bomb: Screen-clearing attack (limited charges)
  - Hyperspace: Emergency teleport (risky spawn)

#### 4.1.2. Guardian Form
**Implementation Status: 100% Complete ‚úÖ**

‚úÖ **Fully Implemented:**
- Activation: Toggle button
- Movement: Drastically slowed
- Aim/Fire: 360¬∞ aim (mouse/right stick)
- Firepower: Higher DPS, special shot types
- **Critical for Assault Missions:** Base destruction benefits from sustained fire (assault missions not yet implemented)

---

### 4.2. Ground Combat & Operative System

**Implementation Status: 30% Complete**

#### 4.2.1. Ship Destruction ‚Üí Foot Combat
**Implementation Status: 40% Complete**

‚úÖ **Implemented:**
- Ship destroyed ‚Üí Pilot ejects and lands near crash site
- Basic on-foot movement with gravity and jumping
- Pilot uses the same weapon/projectile system while on foot
- Re-entry to rebuilt ship after extraction

‚ùå **Missing:**
**Ejection Sequence:**
- Rescue nearby comrades to form a squad

**On-Foot Mechanics:**
- Weapons: Pistol, rifle, grenades, improvised weapons (currently uses same ship weapons)
- Cover System: Use debris, buildings, destroyed vehicles
- **Assault Mission Advantage:** Ground combat effective against base defenses
- **Operative AI:**
  - Basic Combat: Auto-fire at enemies
  - Special Roles:
    - Turret Operative: Man mounted guns
    - Medic: Heal player
    - Engineer: Repair vehicles / Sabotage enemy base systems

#### 4.2.2. Rebuilding/Extraction
**Implementation Status: 60% Complete**

‚úÖ **Implemented:**
- Rescue dropship extraction encounter
- Trigger mini-boss fight to secure extraction
- Return to system map with ship rebuilt

‚ùå **Missing:**
**Rebuild Station (Optional):**
- Collect alien tech to rebuild stronger ship (risk/reward)

#### 4.2.3. Comrade Rescue & Mutation Risk
**Implementation Status: 50% Complete**

‚úÖ **Implemented:**
- Touch comrades to pick them up (basic rescue)
- Landers abduct humans and mutate them
- Score rewards for rescues
- Mutant enemies as threats

‚ùå **Missing:**
**Rescue Mechanics:**
- While carried, they fire at enemies (gun pod effect)
- Deposit at safe zones for:
  - Score/currency
  - Temporary buffs (e.g., shield recharge)

**Mutation Risk:**
- Kill mutants for bonus points OR risk rescuing them back
- **In Occupied Districts:** Fewer comrades available (most captured/converted)

---

### 4.3. Power-Up & Weapon System

#### 4.3.1. Power Sources
**Implementation Status: 85% Complete**

‚úÖ **Implemented:**
- Airborne Power Capsules: Dropped by enemies
- Surface Items: Scattered on ground (fly low to collect)

‚ùå **Missing:**
- **Base Destruction Rewards:** Major power-ups from destroyed enemy bases

#### 4.3.2. Upgrade Paths
**Implementation Status: 60% Complete**

‚úÖ **Implemented:**
- Laser: Single ‚Üí Spread ‚Üí Wave Beam
- Drones (basic implementation)
- Shield system
- Homing Missiles
- Overdrive mode
- Additional modifiers: rear/side/rapid/multi/piercing/speed/magnet/double/invincibility/timeSlow

‚ùå **Missing:**

| System | Current Status | Design Goal |
|--------|----------------|-------------|
| Laser | Single ‚Üí Spread ‚Üí Wave | Single ‚Üí **Twin** ‚Üí Spread ‚Üí Wave Beam |
| Force Drone | Basic only | Front ‚Üí Orbit ‚Üí Detached |
| Shield | Basic only | Ablative segments ‚Üí Timed invulnerability |
| Homing Missiles | Basic only | Basic ‚Üí Swarms ‚Üí Guided Barrage |
| Overdrive | Basic only | +Duration ‚Üí +Damage ‚Üí Screen-Filling Chaos |

#### 4.3.3. Combo Examples
**Implementation Status: 0% Complete**

‚ùå **Missing:**
- Force Drone + Spread Laser: Rotating projectile ring
- **Afterburner + Shield: "Ram Mode" - crash into base defenses safely**
- **Homing Missiles + Overdrive: Apocalypse swarm - base siege weapon**

---

## 5. Mission Types

### 5.1. Defense Missions (Threatened Districts)

**Implementation Status: 70% Complete**

‚úÖ **Implemented:**
- Wave-based combat system
- Enemy spawning with increasing difficulty
- Boss encounters at wave completion
- Human rescue mechanics
- Power-up drops

‚ùå **Missing:**

**Objective:** Survive 15 waves of enemies (currently variable wave count)

**Structure:**
- Waves 1-5: Light forces (scouts, drones)
- Waves 6-10: Heavy forces (bombers, landers)
- Waves 11-14: Elite forces (cyber-mutants, assault pods)
- Wave 15: **Battleship** mini-boss

**Success:** District remains friendly (state change not implemented)
**Failure:** District becomes occupied (requires assault mission)

**Special Features:**
- High comrade density to rescue (not emphasized)
- Power-up drops increase per wave (basic version exists)
- Bonus rewards for zero civilian casualties

---

### 5.2. Assault Missions (Occupied Districts)

**Implementation Status: 0% Complete**

‚ùå **Missing - Complete System:**

**Objective:** Destroy the enemy ground base

**Structure:**
- Heavy enemy presence throughout district
- **Ground Base Components:**
  - Shield Generators (must destroy to expose core)
  - Defensive Turrets (auto-targeting)
  - Garrison Forces (elite units defending base)
  - Core Reactor (primary target)

**Tactics:**
- Air superiority: Destroy turrets and air defenses
- Ground assault: Deploy on foot to sabotage systems
- Engineers can disable shields faster
- Base destruction triggers explosion and evacuation sequence

**Success:** District returns to friendly control + major reward
**Failure:** Forced retreat, district remains occupied

**Special Features:**
- Minimal comrade presence (most converted to mutants)
- High-value power-ups inside base
- Risky but rewarding infiltration opportunities

---

## 6. Environment Design

### 6.1. Parallax Cityscape
**Implementation Status: 40% Complete**

‚úÖ **Implemented:**
- Procedurally generated parallax background layers
- Basic cityscape visuals

‚ùå **Missing:**
- Foreground: Destroyable buildings, hidden pickups
- Mid-Ground: Traffic, civilians, flying cars
- Background: Megastructures, dynamic weather
- Sky Layer: Day/night cycle affecting visibility

### 6.2. District Themes

**Implementation Status: 0% Complete**

‚ùå **Missing - Complete System:**

| District | Defense Features | Assault Features |
|----------|------------------|------------------|
| Downtown Core | Narrow corridors; ideal for Guardian Mode | Fortified skyscrapers; vertical base structures |
| Industrial Zone | Crushing machinery, toxic spills | Factory bases with assembly line defenses |
| Residential Sector | High comrade density; hostage situations | Underground bunker bases |
| Dockyards | Water enemies, cranes | Naval base with water defenses |
| Orbital Platform | Low gravity, rotating platforms | Space station base with shield layers |

---

## 7. System Map & Meta Layer

### 7.1. System Map Mechanics

**Implementation Status: 45% Complete**

‚úÖ **Implemented:**
- District threat states (friendly/threatened/occupied)
- District occupation tracking
- Weapons Satellite shop node
- Orbit nodes with timers (shop/relay/distress/mothership)
- Meta currency system
- Permanent upgrade purchases
- Roaming entities (current "motherships") drain district timers during assaults
- Urgency-based mission modifiers
- üü¢ **Friendly**, üü° **Threatened**, üî¥ **Occupied** district status flow

‚ùå **Missing:**

**Dynamic Threats:**
- **Battleships** roam the map, targeting friendly districts (need to rename current "motherships")
- Districts under battleship attack become threatened
- Timer countdown shows when district will fall if not defended
- Ignoring threats ‚Üí District captured ‚Üí New assault mission appears

**Strategic Layer:**
- Prioritize defenses vs. reclamation
- Some districts may be more valuable (resources, strategic position)
- Losing key districts increases battleship aggression

### 7.2. Mothership Assault (Final Mission)

**Implementation Status: 0% Complete**

‚ùå **Missing - Complete System:**

**Unlock Condition:** All districts must be friendly (none occupied)

**Structure:**
- **Phase 1:** Exterior defense ring (battleship gauntlet)
- **Phase 2:** Interior corridors with traps and elite forces
- **Phase 3:** Core boss fight (Mothership Queen/AI)

**End Conditions:**
- **Victory:** Destroy Mothership core ‚Üí Campaign complete
- **Perfect Run:** Complete campaign without losing any district ‚Üí Special ending
- **Defeat:** Retreat and continue liberating districts

---

## 8. Enemy Design

### 8.1. Standard Forces

**Implementation Status: 90% Complete**

‚úÖ **Implemented:**
- Landers (abduct humans, create mutants)
- Mutants (fast enemies)
- Bombers (bomb patterns)
- Swarmers (overwhelming numbers)
- Drones (basic patrol)
- Additional enemies: turret, shield, shielder, seeker, spawner, kamikaze, baiter, bouncer, sniper, swarm leader, regenerator

‚ùå **Missing:**

| Enemy Type | Behavior | Defense/Assault |
|------------|----------|-----------------|
| Landers | ‚úÖ Implemented | ‚ùå Should be Defense only |
| Mutants | ‚úÖ Implemented | ‚ùå Both (more in Assault) - not differentiated |
| Bombers | ‚úÖ Implemented | ‚ùå Should be Defense waves |
| Swarmers | ‚úÖ Implemented | ‚úÖ Both contexts |
| Drones | ‚úÖ Implemented | ‚úÖ Both contexts |

- Mutants hijacking vehicles/turrets

### 8.2. Elite Forces

**Implementation Status: 30% Complete**

‚úÖ **Implemented:**
- Multiple boss archetypes with behaviors
- Current "motherships" as roaming threats

‚ùå **Missing:**

| Enemy Type | Behavior | Primary Context |
|------------|----------|-----------------|
| **Battleships** | Wave 15 mini-boss; roams system map | Defense missions (rename from "motherships") |
| Cyber-Mutants | Blink/teleport, hybrid tech | Assault missions |
| Kaiju Units | Multi-limb bosses; destroy limbs for advantage | Special events |
| Base Defenders | Elite units protecting ground bases | Assault missions only |

### 8.3. Base Defenses (Assault Only)

**Implementation Status: 0% Complete**

‚ùå **Missing - Complete System:**
- **Turrets:** Auto-targeting defense systems
- **Shield Generators:** Protect core reactor
- **Garrison Forces:** Elite troops defending base perimeter
- **Core Reactor:** Primary target, heavily armored

---

## 9. Game Systems

### 9.1. Radar / HUD

**Implementation Status: 60% Complete**

‚úÖ **Implemented:**
- Mini-radar showing player, enemies, humans, pickups
- System map flashing districts for threats
- Core HUD elements (score, wave count, timer, bombs, lives)
- Power-up status readout

‚ùå **Missing:**

**Combat View:**
- **Mission Objective Indicator:**
  - Defense: Wave count (X/15) - currently shows generic wave count
  - Assault: Base health bar
- Off-screen arrows for priority targets

**System Map:**
- Red districts (occupied)
- Battleship positions and movement paths
- District timers (countdown to fall)

### 9.2. Scoring & Rewards

**Implementation Status: 50% Complete**

‚úÖ **Implemented:**
- Enemy kills
- Human rescues
- Score display and tracking
- Wave-completion bonuses
- Mission completion credit rewards
- Currency conversion (meta credits)

‚ùå **Missing:**

**Points For:**
- Comrade rescues/**survival** (rescue implemented, survival tracking missing)
- Mutant reconversions
- **Base destruction** (major bonus)
- No-death runs
- Perfect district defense (no civilian casualties)

**Currency Conversion:**
- **District Liberation Bonus:** Major currency reward for assault victories
- Unlocks cosmetics/challenges

---

## 10. Progression & Modes

### 10.1. Core Mode: Planetary Liberation Campaign

**Implementation Status: 40% Complete**

‚úÖ **Implemented:**
- District-based mission structure
- District destruction consequences
- Run-to-run variation
- Wave and survival combat modes

‚ùå **Missing:**

**Campaign Structure:**
- Start with 30-50% districts friendly, rest occupied
- Battleships begin attacking friendly districts
- Goal: Secure all districts ‚Üí Unlock Mothership ‚Üí Destroy Mothership

**Dynamic Campaign:**
- Player choices shape the battlefield
- Lost defenses create new assault challenges
- Strategic decisions affect difficulty curve

### 10.2. Mission Mode

**Implementation Status: 0% Complete**

‚ùå **Missing - Complete System:**
- Handcrafted scenarios:
  - Hold Sector X for 5 minutes
  - **Assault Fortress Base in under 10 minutes**
  - Escort VIP transports
  - **Sabotage enemy supply lines**

### 10.3. Boss Rush

**Implementation Status: 0% Complete**

‚ùå **Missing - Complete System:**
- Sequential boss fights:
  - All **battleship** encounters
  - **Special assault base commanders**
  - Final **Mothership** battle

### 10.4. Daily/Weekly Challenges

**Implementation Status: 0% Complete**

‚ùå **Missing - Complete System:**

**Mutators:**
- Double enemy speed
- Only Guardian Mode allowed
- Limited weapons
- **"Assault Only"** - All districts start occupied
- **"Last Stand"** - All districts threatened simultaneously

---

## 11. Difficulty & Replayability

**Implementation Status: 35% Complete**

‚úÖ **Implemented:**
- Basic difficulty scaling through waves
- Meta progression unlocks
- Persistent loadout system
- District urgency scaling

‚ùå **Missing:**

**Scaling Systems:**
- More occupied districts ‚Üí Stronger battleship forces
- Failed defenses ‚Üí Harder assault missions
- District liberation ‚Üí Unlocks harder battleship variants

**Unlocks:**
- New ship skins
- Permanent buffs for Perfect Runs
- Harder Mothership variants
- **Base assault equipment** (bunker busters, EMP bombs)

**Meta Progression:**
- Persistent upgrades carry between campaigns
- Unlock starting advantages (more friendly districts)
- Cosmetic rewards for perfect defense records

---

## 12. Key Design Changes Summary

### Previous System vs. New System

**Previous System:**
‚úÖ Districts only defended from attacks (partially implemented)
‚ùå Single "enemy base" endgame (not implemented)
‚úÖ Motherships were mini-bosses (implemented but need redesign)

**New System:**
‚ùå **Districts have three states:** Friendly, Threatened, Occupied (not implemented)
‚ùå **Two mission types:**
  - **Defense:** 15 waves (current system has variable waves)
  - **Assault:** Destroy enemy ground base (not implemented)
‚ùå **Battleships** are mini-bosses that attack districts (need to rename current motherships)
‚ùå **Mothership** is the final boss (unlocked when all districts secured) (not implemented)
‚ùå **Strategic layer:** Balance defending territory vs. reclaiming lost ground (not implemented)
‚úÖ **Dynamic campaign:** Player failure creates new challenges (partially implemented - districts can be occupied)
‚ùå **Clear victory path:** Secure planet ‚Üí Assault Mothership ‚Üí Win (not implemented)

---

## Implementation Priority Summary

### Critical Path to MVP (Priority Order):

1. ‚ùå **HIGH PRIORITY:** Implement district three-state system (Friendly/Threatened/Occupied)
2. ‚ùå **HIGH PRIORITY:** Create assault mission type with base destruction mechanics
3. ‚ùå **HIGH PRIORITY:** Rename motherships ‚Üí battleships, implement as wave 15 boss
4. ‚ùå **HIGH PRIORITY:** Add Mothership node (unlocked when all districts friendly)
5. ‚ö†Ô∏è **MEDIUM PRIORITY:** Standardize defense missions to 15 waves
6. ‚ö†Ô∏è **MEDIUM PRIORITY:** Implement district state transitions (failed defense ‚Üí occupied)
7. ‚ö†Ô∏è **MEDIUM PRIORITY:** Add campaign victory condition (destroy Mothership)
8. ‚ö†Ô∏è **LOW PRIORITY:** District themes and environmental variations
9. ‚ö†Ô∏è **LOW PRIORITY:** Additional game modes (Mission Mode, Boss Rush, Challenges)
10. ‚ö†Ô∏è **LOW PRIORITY:** Enhanced ground combat and operative squad system

---

## Overall Completion Statistics

**Core Systems:**
- Fully Complete: 2/12 (17%) - Normal Fighter Form, Guardian Form
- Partially Complete: 8/12 (67%)
- Not Started: 2/12 (16%) - Assault Missions, Mothership Final Boss

**Design Document Alignment:**
- ‚úÖ Implemented: ~45%
- ‚ö†Ô∏è Partially Implemented: ~35%
- ‚ùå Not Implemented: ~20%

**Critical Missing Features for Design Document Compliance:**
1. Assault mission implementation (complete system)
2. Battleship redesign (rename + wave 15 mini-boss behavior)
3. Mothership final boss node and mission
4. Strategic campaign layer and victory path
5. Fixed 15-wave defense structure
6. Ground base destruction mechanics
7. Operative squad system
8. District-specific themes and variations
9. Additional game modes and challenges
